+++
title = "响应面分析"
date = 2022-10-03
[taxonomies]
categories = ["小妙招"]
tags = ["software"]
+++

# 详细解析「响应面设计」及相关软件「Design-Expert」的使用   
- - - 

> 在过程优化里，最常用到的方法有三个：单因素试验、正交试验和响应面分析。其中，单因素试验是在假设因素间不存在交互作用的前提下，每次只改变一个因素且保证其他因素维持在恒定水平的条件下，研究不同试验水平对响应值的影响。  
然而，大多数过程影响因素相当复杂，而且因素间通常又存在交互作用，并且当试验因素很多时，需要进行多次试验和较长的试验周期才能完成各因素的逐个优化。   正交试验可同时考虑多个因素，注重科学合理安排试验，以寻找最佳的因素水平组合。它的试验次数明显少于同因素同水平的单因素试验，可通过方差分析得到影响试验结果的主次因素，以及考虑因素间的交互作用等等。    
但当考虑因素之间的交互作用时，其试验次数会大大增加，工作量巨大。

**这个时候，响应面分析应运而生**  

## 响应面分析法  
响应面分析法，即响应曲面设计方法（Response Surface Methodology，RSM），是通过设计合理的有限次数试验，建立一个包括各显著因素的一次项、平方项和任何两个因素之间的一级交互作用项的数学模型，精确研究各因素与响应值之间的关系，快速有效地确定多因素系统的最佳条件.   
该方法具有试验次数少、周期短、精度高等优点，是一种有效地优化基础试验条件的技术。   
## 什么时候可以选用响应面法进行分析？  
当你确信或者怀疑因素对指标存在非线性影响，所有因素均为计量值数据并且试验区域已接近最优区域的时候，就可以用响应面法来设计优化你的试验。响应面分析的一般步骤：  

确定因素及水平：注意因素数一般不超过 4 个，因素均为计量值数据  

方法选择：创建「中心复合」或者「Box-Behnken」设计  

确定试验运行顺序  

进行试验并收集数据  

分析试验数据  

优化因素的设置水平   

验证试验  

其中，确定因素方法一般**采用 Plackett-Burman 法**，这是一种以不完全平衡块（balanced incomplete blocks）为原理的部分析因实验设计法，**适用于从众多的考察因素中快速、有效的筛选出最为重要的几个因素**，供进一步详细研究使用。  

确定水平一般**采用最陡爬坡试验**，该试验分别对 3 个显著因素的正负效应设计最陡爬坡试验路径，包括各因素的变化步长和变化方向，以便最快地逼近最大响应区域。  
 
响应面常用的方法有两种：**中心复合试验设计（central composite design，CCD）和 Box-Behnken 试验设计（BBD）**。  

常用的响应面设计和分析软件有 Matlab、SAS 和 Design-Expert。在已经发表的有关响应面（RSM）优化试验的论文中，Design-Expert 是使用最广泛的软件。   

Design-Expert 软件是由 State-East 公司开发的一款面向试验设计的相关分析的软件，相对于其他数理分析软件 JMP、SAS、Minitab 等，它具有使用简单，不需数理统计功底，就可以用设计出高效的试验方案，并对实验数据做专业的分析，给出全面、可视的模型以及优化结果。  
## 具体操作方法  
1. 首先打开软件 Design-Expert.V8.0.6.1，选择建立新的实验设计方案或者打开之前的试验设计方案。  ![](https://img1.dxycdn.com/2019/1016/959/3374162155728919870-14.jpg)
2. 此处我们点击 New Design。根据要求和试验设计选择输入数值。

> 此处简单介绍下 BLOCK 的含义，例如实验需要在两个不同的实验室完成，因为其中一些其他不可控制的因素的变化可能会对试验造成影响，就是两个区块，可以设置 2 个 BLOCK，软件会在 BLOCK 中设置对应的几个中点试验重复，检查中点试验的重复性是否良好。以观察这些不可控制因素对试验造成多大影响。从而最大限度的降低试验中不可控制因素对试验的干扰。  

![](https://img1.dxycdn.com/2019/1016/140/3374162202973560900-14.jpg)  
3. 根据试验设计输入响应值的数量、名称和单位。  ![](https://img1.dxycdn.com/2019/1016/754/3374162256660652989-14.jpg)
4. 此时就会出现试验设计表，前两列为实验顺序，可以选择其中一列作为自己的试验顺序，3 - 5 列为三个因素水平的设置（此时显示的为具体数值，下一步我们将转换为编码值），最后一列是响应值的填写位置。  ![](https://img1.dxycdn.com/2019/1016/498/3374162323232503903-14.jpg)
5. 我们将数值转变为编码值。点击 Display Options 后再点击 Process Factors，选择 Coded，将真实数值转变为编码值。当水平数目为三水平时：高点编码值为 1，中点编码值为 0，低点编码值为 - 1。  ![](https://img1.dxycdn.com/2019/1016/935/3374162353297275542-14.jpg)
6. 转变后，将试验得到的结果数值输入到后面的响应值框内。点击左端的 Analysis 进行数据分析。  ![](https://img1.dxycdn.com/2019/1016/109/3374162419869412835-14.jpg)  
（1）Transform 选项卡，一般选择默认值即可。如果有别的要求，可以根据需要和指示查找每种模式的详细介绍再选择。   

（2）Fit Summary 选项卡。了解一下各项，再点击 Model 选项卡。    ![](https://img1.dxycdn.com/2019/1016/101/3374162449934041207-14.jpg)   
（3）Model 选项卡取默认值即可。   

（4）点击 ANOVA 选项卡，显示方差分析，方差的显著性检验，系数显著性检验回归方程。  ![](https://img1.dxycdn.com/2019/1016/522/3374162484293780145-14.jpg)   
7. 点击 Diagnostics 选项卡，依次点击左端选项，首先展示的是 Normal Plot，参差的正态规律分布图，图中的点越靠近直线越好。   ![](https://img1.dxycdn.com/2019/1016/891/3374162565898160343-14.jpg)  
8. 第二个展示残差与方程预测值的对应关系图，分布越分散越无规律越好。   ![](https://img1.dxycdn.com/2019/1016/071/3374162606700493247-14.jpg)  
9. 最后展示的是预测值和试验实际值的对应关系图，点越靠近同一条直线越好。  ![](https://img1.dxycdn.com/2019/1016/524/3374162634617781085-14.jpg)   
10. 然后点击 Influence 后再点击 Report 进入结果界面，数据显示如图，包含试验实际测量值和方程预测值。   ![](https://img1.dxycdn.com/2019/1016/705/3374162701189775325-14.jpg)   
11. 然后点击 Model Graphs 查看等高线图，等高线图考察每两个因素对因变量造成的影响，并由拟合的方程形成等高线，为二维平面图形，可经由该图找出较好的范围。  ![](https://img1.dxycdn.com/2019/1016/705/3374162701189775325-14.jpg)   
12. 三维响应曲面图可更加直观地看出两因素的影响情况，可以很直观地找出最优范围，刚才所看到的二维等高线图即为三维响应面图在底面的投影图。   ![](https://img1.dxycdn.com/2019/1016/448/3374162731254546898-14.jpg)   
13. 接下来就是关键的优化条件选项，首先根据实际情况确定每个因素可以取值的范围，例如在酶催化条件优化试验，温度范围一般不会超过 80℃，否则酶会变性，那么我们就可设置该因素取值范围为 0 - 80，也可以根据实际实验或者生产条件设置该值。  ![](https://img1.dxycdn.com/2019/1016/451/3374162754876867378-14.jpg)   
14. 然后进行「响应值目标」的确定，每个试验都有不同的目的，比如此处我们想要找到能使阿维菌素最大产出量的最优培养条件，但别的试验中对目标的要求有需要最大值，有需要最小值，有时候需要把结果稳定在某个范围或者需要一个固定的数值。那么在这四种模式中就可以选择其相对应的情况。![](https://img1.dxycdn.com/2019/1016/750/3374162782794155228-14.jpg)   
15. 上一步完成后在此处点击 Solutions 选项卡，即可看到经过分析得到的最优值，一般会列出许多方案，第一个方案就是各因素取最优值后的结果可取到的最大化的解决方案，为预测值。   ![](https://img1.dxycdn.com/2019/1016/593/3374162808563959372-14.jpg)  
16. 最后，可以保存文件。